{"remainingRequest":"/Users/tim/Desktop/电商程序/package 2/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tim/Desktop/电商程序/package 2/src/views/productManager/productList/index.vue?vue&type=style&index=0&id=e0614a0e&lang=scss","dependencies":[{"path":"/Users/tim/Desktop/电商程序/package 2/src/views/productManager/productList/index.vue","mtime":1714329537387},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmVsLWNvbGxhcHNlLWl0ZW1fX2hlYWRlcnsNCiAgICBtYXJnaW4tbGVmdDogMTBweCFpbXBvcnRhbnQ7DQogICAgZm9udC1zaXplOiAxOHB4Ow0KfQ0KLnNlYXJjaCB7DQogIHBhZGRpbmc6IDMwcHggMjBweCAxMHB4IDEwcHg7DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqSA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/productManager/productList","sourcesContent":["<template>\r\n  <div class=\"product-main\">\r\n    <!-- <el-collapse class=\"collapse\" v-model=\"activeNames\"> -->\r\n      <!-- <el-collapse-item title=\"商品查询\" name=\"1\"> -->\r\n        <el-form\r\n          label-width=\"80px\"\r\n          :inline=\"false\"\r\n          class=\"search\"\r\n          size=\"normal\"\r\n        >\r\n          <el-row :gutter=\"10\">\r\n            <el-col class=\"searchItem\" :span=\"6\" :offset=\"0\">\r\n              <el-form-item label=\"商品名称\" size=\"mini\">\r\n                <el-input\r\n                  v-model=\"keyword\"\r\n                  class=\"search-input\"\r\n                  size=\"mini\"\r\n                  placeholder=\"商品名称/模糊查询\"\r\n                />\r\n              </el-form-item>\r\n            </el-col>\r\n            <!-- <el-col class=\"searchItem\" :span=\"6\" :offset=\"0\">\r\n              <el-form-item label=\"上架状态\" size=\"mini\">\r\n                <el-select\r\n                  v-model=\"search.publishStatus\"\r\n                  class=\"search-input\"\r\n                  size=\"mini\"\r\n                  clearable\r\n                  placeholder=\"上架状态\"\r\n                >\r\n                  <el-option label=\"上架\" value=\"1\" />\r\n                  <el-option label=\"未上架\" value=\"0\" />\r\n                </el-select>\r\n              </el-form-item>\r\n            </el-col> -->\r\n            <el-col style=\"float: right\" :span=\"4\" :offset=\"0\">\r\n              <el-button type=\"primary\" size=\"mini\" @click=\"doSearch\"\r\n                >搜索</el-button\r\n              >\r\n              <el-button type=\"default\" size=\"mini\" @click=\"doReset\"\r\n                >重置\r\n              </el-button>\r\n            </el-col>\r\n          </el-row>\r\n        </el-form>\r\n      <!-- </el-collapse-item> -->\r\n    <!-- </el-collapse> -->\r\n\r\n    <!-- 商品列表 -->\r\n    <el-card class=\"card\" shadow=\"never\">\r\n      <div slot=\"header\">\r\n        <el-button\r\n          type=\"primary\"\r\n          size=\"mini\"\r\n          @click=\"addProduct\"\r\n          >新增</el-button\r\n        >\r\n\r\n        <!-- <el-button\r\n          type=\"primary\"\r\n          size=\"mini\"\r\n          :loading=\"downloadLoading\"\r\n          @click=\"handleDownload\"\r\n        >\r\n          导出商品列表excel文件\r\n        </el-button> -->\r\n      </div>\r\n      <!-- 商品列表 -->\r\n\r\n      <!-- 商品列表 -->\r\n\r\n      <el-table\r\n        :data=\"productList\"\r\n        border\r\n        style=\"width: 100%\"\r\n      >\r\n        <el-table-column type=\"index\" label=\"序号\" fixed=\"left\" />\r\n        <el-table-column label=\"商品图片\" width=\"180\" prop=\"pic_url\">\r\n          <template slot-scope=\"scope\">\r\n            <img\r\n              style=\"width: 100px; height: 100px\"\r\n              :src=\"scope.row.pic_url\"\r\n              class=\"avatar\"\r\n            />\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"商品名称\" width=\"240\" prop=\"name\">\r\n        </el-table-column>\r\n        <el-table-column label=\"商品价格\" width=\"200\" prop=\"price\">\r\n        </el-table-column>\r\n        <!-- <el-table-column label=\"商品优惠券\" width=\"180\" prop=\"stock\">\r\n        </el-table-column> -->\r\n        <el-table-column label=\"商品类别\" width=\"200\" prop=\"tags\">\r\n        </el-table-column>\r\n        <el-table-column label=\"生产日期\" width=\"200\" prop=\"brand\">\r\n        </el-table-column>\r\n        <el-table-column label=\"保质期\" width=\"200\" prop=\"stock\">\r\n        </el-table-column>\r\n        <el-table-column label=\"注释\" width=\"400\" prop=\"tags\">\r\n        </el-table-column>\r\n        <el-table-column label=\"是否过期\">\r\n          <template slot-scope=\"scope\">\r\n            <span v-if=\"isExpired(scope.row.brand, scope.row.stock)\">\r\n                已过期\r\n            </span>\r\n            <span v-else>\r\n                未过期\r\n            </span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column fixed=\"right\" label=\"操作\" width=\"250\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n              type=\"text\"\r\n              size=\"small\"\r\n              @click=\"edit(scope.row)\"\r\n              >编辑</el-button>\r\n              <el-button\r\n              type=\"text\"\r\n              size=\"small\"\r\n              @click=\"details(scope.row)\"\r\n              >详情</el-button>\r\n            <el-button\r\n              type=\"text\"\r\n              size=\"small\"\r\n              @click=\"deletes(scope.row.id)\"\r\n              ><span style=\"color: red\">删除</span></el-button>\r\n            </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <!-- 所有列表都要有分页 除非有特殊要求 否则数据多的情况下就没办法看了 -->\r\n      <el-pagination\r\n        @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\"\r\n        :current-page=\"currentPage4\"\r\n        :page-sizes=\"[10, 20, 50, 100]\"\r\n        :page-size=\"limit\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        :total=\"total\">\r\n      </el-pagination>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { comList, comDelete } from '@/api/api.js'\r\nexport default {\r\n  name: \"ProductList\",\r\n  components: {},\r\n  data() {\r\n    return {\r\n      downloadLoading: false,\r\n      activeNames: [\"1\"],\r\n      keyword: '',\r\n      loading: true, // 加载\r\n      productList: [],\r\n      currentPage4: 1,//当前页\r\n      limit: 10,//每页条数\r\n      page: 1,//页数\r\n      total: null//总条数\r\n    };\r\n  },\r\n  created() {\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    getList() {\r\n      let params = {\r\n        limit: this.limit,\r\n        page: this.currentPage4,\r\n        keyword: this.keyword\r\n      }\r\n      comList(params).then( res => {\r\n        console.log(res)\r\n        if(res.code === 1){\r\n          this.productList = res.data.list\r\n          this.total = res.data.count\r\n        }\r\n      })\r\n    },\r\n    deletes(id) {\r\n      this.$confirm('删除后不可恢复, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          let params = {\r\n            id: id\r\n          }\r\n          comDelete(params).then(res => {\r\n            console.log(res)\r\n            if(res.code === 1) {\r\n              this.$message({\r\n                message: '删除成功',\r\n                type: 'success'\r\n              })\r\n              this.getList()\r\n            }\r\n          })\r\n        }).catch(() => {\r\n        });\r\n    },\r\n    //分页\r\n    handleSizeChange(val) {\r\n      console.log(`每页 ${val} 条`);\r\n    },\r\n    handleCurrentChange(val) {\r\n      console.log(`当前页: ${val}`);\r\n      this.getList()\r\n    },\r\n\r\n    // 重置搜索栏\r\n    doReset() {\r\n      this.keyword = ''\r\n      this.currentPage4 = 1\r\n      this.limit = 10\r\n    },\r\n    // 搜索按钮\r\n    doSearch() {\r\n      this.getList()\r\n    },\r\n    // 新增商品\r\n    addProduct() {\r\n      this.$router.push({ name: 'addProductDetail' })\r\n    },\r\n    //编辑\r\n    edit(data) {\r\n      this.$router.push({ name: 'addProductDetail',\r\n        query: {\r\n          id: data.id,\r\n          type: 0\r\n        }\r\n      })\r\n    },\r\n    details(data) {\r\n      this.$router.push({ name: 'addProductDetail',\r\n        query: {\r\n          id: data.id,\r\n          type: 1\r\n        }\r\n      })\r\n    },\r\n    isExpired(brand, stock) {\r\n      // 获取当前日期\r\n      const currentDate = new Date();\r\n\r\n      // 将brand转换为日期对象\r\n      const productionDate = new Date(brand);\r\n\r\n      // 将stock转换为整数（保质期天数）\r\n      const shelfLifeDays = parseInt(stock);\r\n\r\n      // 计算产品的过期日期\r\n      const expirationDate = new Date(productionDate);\r\n      expirationDate.setDate(productionDate.getDate() + shelfLifeDays);\r\n\r\n      // 判断产品是否变质\r\n      return currentDate >= expirationDate;\r\n    },\r\n    //导出商品列表\r\n    handleDownload() {\r\n      //      <p>{{ scope.row.name }}</p>\r\n      //     <p>品牌: {{ scope.row.brandName }}</p>\r\n      //     <p>{{ scope.row.description }}</p>\r\n      //   </template>\r\n      // </el-table-column>\r\n      // <el-table-column align=\"center\" label=\"商品价格\" width=\"150\">\r\n      //   <template slot-scope=\"scope\">\r\n      //     <p>原价: {{ scope.row.originalPrice | money }}</p>\r\n      //     <p>现价: {{ scope.row.price | money }}</p>\r\n      // this.downloadLoading = true\r\n      // import('@/vendor/Export2Excel').then((excel) => {\r\n      //     const tHeader = ['商品名称', '商品品牌', '商品价格']\r\n      //     const filterVal = ['name', 'brandName', 'price']\r\n      //     const list = this.productList\r\n      //     const data = this.formatJson(filterVal, list)\r\n      //     // console.log('list===',JSON.stringify()list)\r\n      //     excel.export_json_to_excel({\r\n      //         header: tHeader,\r\n      //         data,\r\n      //         filename: this.filename,\r\n      //         autoWidth: this.autoWidth,\r\n      //         bookType: this.bookType\r\n      //     })\r\n      //     this.downloadLoading = false\r\n      // })\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n<style lang=\"scss\">\r\n.el-collapse-item__header{\r\n    margin-left: 10px!important;\r\n    font-size: 18px;\r\n}\r\n.search {\r\n  padding: 30px 20px 10px 10px;\r\n}\r\n</style>\r\n"]}]}