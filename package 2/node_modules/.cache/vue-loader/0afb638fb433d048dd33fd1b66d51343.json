{"remainingRequest":"/Users/tim/Desktop/电商程序/package 2/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tim/Desktop/电商程序/package 2/src/views/userMember/identity/index.vue?vue&type=style&index=0&id=adcef1be&scoped=true&lang=scss","dependencies":[{"path":"/Users/tim/Desktop/电商程序/package 2/src/views/userMember/identity/index.vue","mtime":499162500000},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/css-loader/dist/cjs.js","mtime":1713682102723},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1713682104596},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/postcss-loader/src/index.js","mtime":1713682103225},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/sass-loader/dist/cjs.js","mtime":1713682101846},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/cache-loader/dist/cjs.js","mtime":1713682101844},{"path":"/Users/tim/Desktop/电商程序/package 2/node_modules/vue-loader/lib/index.js","mtime":1713682103513}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5idG4tYm94IHsKICBtYXJnaW46IDBweCAzMHB4Owp9Ci5zZWFyY2ggewogIHBhZGRpbmc6IDMwcHggMjBweCAxMHB4IDIwcHg7Cn0KLm9yZGVyLW1haW4gewogIC5zZWFyY2hGb3JtIHsKICAgIDo6di1kZWVwIC5lbC1mb3JtLWl0ZW0gewogICAgICBsYWJlbCB7CiAgICAgICAgZm9udC13ZWlnaHQ6IG5vcm1hbDsKICAgICAgfQogICAgfQogIH0KICAuY2FyZCB7CiAgICBtYXJnaW46IDEwcHggMzBweDsKICB9CiAgLnNlYXJjaC1tYWluIHsKICAgIC5zZWFyY2gtaW5wdXQgewogICAgICB3aWR0aDogMjAwcHg7CiAgICB9CiAgfQogIC50YWJsZV9pbWcgewogICAgd2lkdGg6IDEwMHB4OwogICAgaGVpZ2h0OiAxMDBweDsKICB9CiAgLnNlYXJjaEJ0bl93cmFwcGVyIHsKICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IHJvdy1yZXZlcnNlOwogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/userMember/identity","sourcesContent":["<template>\n  <div class=\"order-main\">\n    <el-form label-width=\"80px\" :inline=\"false\" class=\"search\" size=\"normal\">\n      <el-row :gutter=\"10\">\n        <el-col class=\"searchItem\" :span=\"6\" :offset=\"0\">\n          <el-form-item label=\"名称\" size=\"mini\">\n            <el-input\n              v-model=\"search.keyword\"\n              class=\"search-input\"\n              size=\"mini\"\n              placeholder=\"请输入关键字\"\n            />\n          </el-form-item>\n        </el-col>\n        <el-col class=\"searchItem\" :span=\"6\" :offset=\"0\"> </el-col>\n        <el-col style=\"float: right\" :span=\"4\" :offset=\"0\">\n          <el-button type=\"primary\" size=\"mini\" @click=\"doSearch()\"\n            >搜索</el-button\n          >\n          <el-button type=\"default\" size=\"mini\" @click=\"doReset()\"\n            >重置\n          </el-button>\n        </el-col>\n      </el-row>\n    </el-form>\n    <div class=\"btn-box\">\n      <el-button type=\"primary\" size=\"mini\" @click=\"addRoleHandler()\"\n        >新增</el-button\n      >\n      <!-- 嵌套表单 -->\n      <el-dialog\n        :title=\"isEdit ? '编辑权限' : '新增权限'\"\n        :visible.sync=\"dialogFormVisible\"\n      >\n        <el-form :model=\"form\" :rules=\"rules\">\n          <el-form-item label=\"名称\" prop=\"name\">\n            <el-input v-model.trim=\"form.name\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"权限\" prop=\"path\">\n            <el-input v-model.trim=\"form.path\"></el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"addRoleFormCancel()\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"addRoleFormOk()\">确 定</el-button>\n        </div>\n      </el-dialog>\n    </div>\n    <!-- 订单列表 -->\n    <el-card class=\"card\" shadow=\"never\">\n      <el-table :data=\"roleList\" border style=\"width: 100%\">\n        <el-table-column align=\"center\" type=\"index\" label=\"#\" fixed=\"left\" />\n        <el-table-column align=\"center\" label=\"id\" prop=\"id\" width=\"100\" />\n        <el-table-column align=\"center\" label=\"名称\" prop=\"name\" />\n        <el-table-column align=\"center\" label=\"权限\" prop=\"path\" />\n        <el-table-column\n          align=\"center\"\n          label=\"创建时间\"\n          prop=\"created_at\"\n          width=\"200\"\n        />\n        <el-table-column\n          align=\"center\"\n          label=\"更新时间\"\n          prop=\"updated_at\"\n          width=\"200\"\n        />\n        <el-table-column align=\"center\" label=\"操作\" width=\"200\">\n          <template slot-scope=\"scope\">\n            <!-- 编辑按钮 -->\n            <el-button\n              type=\"primary\"\n              size=\"mini\"\n              icon=\"el-icon-edit\"\n              @click=\"editRoleHandler(scope.row)\"\n              circle\n            />\n            <!-- 删除按钮 -->\n            <el-button\n              type=\"danger\"\n              size=\"mini\"\n              icon=\"el-icon-delete\"\n              @click=\"deleteRoleHandler(scope.row.id)\"\n              circle\n            />\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <!-- 所有列表都要有分页 除非有特殊要求 否则数据多的情况下就没办法看了 -->\n      <el-pagination\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"currentPage\"\n        :page-sizes=\"[10, 20, 50, 100]\"\n        :page-size=\"limit\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n      >\n      </el-pagination>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport {\n  getPermissionList,\n  addPermission,\n  deletePermission,\n  editPermission,\n} from \"@/api/api.js\";\nexport default {\n  name: \"roleList\",\n  data() {\n    return {\n      roleList: [], // 列表\n      currentPage: 1, //当前页\n      limit: 10, //每页条数\n      page: 1, //页数\n      total: null, //总条数\n      dialogFormVisible: false, // 控制新增弹出框\n      isEdit: false, // 是否是编辑\n      editId: \"\", // 当前编辑id\n      search: {\n        keyword: \"\",\n        timer: null, // 节流\n      },\n      /**\n       * 表单验证\n       */\n      rules: {\n        name: [{ required: true, message: \"请输入名称\", trigger: \"blur\" }],\n        path: [{ required: true, message: \"请输入权限\", trigger: \"blur\" }],\n      },\n      /**\n       * 新增form\n       */\n      form: {\n        name: \"\",\n        path: \"\",\n      },\n    };\n  },\n  computed: {},\n  created() {\n    this.getList();\n  },\n  watch: {\n    dialogFormVisible(newVal) {\n      if (!newVal) {\n        // 清空表单数据，恢复初始数据\n        Object.assign(this.$data.form, this.$options.data().form);\n      }\n    },\n  },\n  methods: {\n    async getList() {\n      this.roleList = [];\n      let params = {\n        /**\n         * 空值显示所有\n         */\n        keyword: this.search.keyword,\n        limit: this.limit,\n        page: this.currentPage,\n      };\n      const res = await getPermissionList(params);\n      console.log(res);\n      console.table(res.data.list);\n      if (res.code === 1) {\n        if (res.data.list.length > 0) {\n          this.roleList = res.data.list;\n          this.total = res.data.count;\n        }\n      }\n    },\n    //分页\n    handleSizeChange(val) {\n      console.log(`每页 ${val} 条`);\n      this.limit = val;\n      this.getList();\n    },\n    handleCurrentChange(val) {\n      console.log(`当前页: ${val}`);\n      this.currentPage = val;\n      this.getList();\n    },\n    // 重置搜索栏\n    doReset() {\n      this.search.keyword = \"\";\n      this.currentPage = 1;\n      this.limit = 10;\n      this.getList();\n    },\n    // 搜索按钮\n    doSearch() {\n      if (this.search.keyword.length > 0) {\n        // 2s节流\n        if (!this.search.timer) {\n          this.search.timer = setTimeout(() => {\n            clearTimeout(this.search.timer);\n            this.search.timer = null;\n          }, 2000);\n          this.getList();\n        }\n      } else {\n        this.$message({\n          message: \"请输入搜索关键字\",\n          type: \"warning\",\n        });\n      }\n    },\n    /**\n     * 新增按钮事件，新增事件\n     */\n    async addRoleHandler() {\n      this.dialogFormVisible = true;\n    },\n    /**\n     * 新增表单 - 取消事件\n     */\n    addRoleFormCancel() {\n      // 关闭表单\n      this.dialogFormVisible = false;\n    },\n    /**\n     * 新增表单 - 确定事件\n     */\n    async addRoleFormOk() {\n      const { name, desc } = this.form;\n      if (name.length < 1 && desc.length < 1) {\n        this.$message({\n          message: \"内容不能为空\",\n          type: \"warning\",\n        });\n        return;\n      }\n      // 是编辑进来的\n      if (this.isEdit) {\n        // 查看改的名字是否有重复\n        if (\n          this.roleList\n            .filter((item) => item.id !== this.editId)\n            .some((item) => item.name === name)\n        ) {\n          this.$message({\n            message: \"已有相同名称\",\n            type: \"warning\",\n          });\n          return;\n        }\n        const res = await editPermission({ ...this.form, id: this.editId });\n        if (res.code === 1) {\n          this.$message({\n            message: \"修改成功\",\n            type: \"success\",\n          });\n        }\n      } else {\n        // 验证是否有相同名称\n        if (this.roleList.some((item) => item.name === name)) {\n          this.$message({\n            message: \"已有相同名称\",\n            type: \"warning\",\n          });\n          return;\n        }\n        const res = await addPermission(this.form);\n        if (res.code === 1) {\n          this.$message({\n            message: \"添加成功\",\n            type: \"success\",\n          });\n        }\n      }\n      // 关闭表单\n      this.dialogFormVisible = false;\n      // 更新页面\n      this.getList();\n    },\n    /**\n     * 编辑事件\n     */\n    editRoleHandler(role) {\n      console.log(role);\n      this.isEdit = true;\n      this.editId = role.id;\n      this.form.name = role.name;\n      this.form.path = role.path;\n      this.dialogFormVisible = true;\n    },\n    /**\n     * 删除事件\n     */\n    deleteRoleHandler(id) {\n      console.log(id);\n      this.$confirm(\"此操作将永久删除该权限, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(async () => {\n          this.$message({\n            type: \"success\",\n            message: \"删除成功!\",\n          });\n          const res = await deletePermission(id);\n          if (res.code === 1) {\n            console.log(res);\n            // 更新页面\n            this.getList();\n          }\n        })\n        .catch(() => {\n          this.$message({\n            type: \"info\",\n            message: \"已取消删除\",\n          });\n        });\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.btn-box {\n  margin: 0px 30px;\n}\n.search {\n  padding: 30px 20px 10px 20px;\n}\n.order-main {\n  .searchForm {\n    ::v-deep .el-form-item {\n      label {\n        font-weight: normal;\n      }\n    }\n  }\n  .card {\n    margin: 10px 30px;\n  }\n  .search-main {\n    .search-input {\n      width: 200px;\n    }\n  }\n  .table_img {\n    width: 100px;\n    height: 100px;\n  }\n  .searchBtn_wrapper {\n    margin-top: 20px;\n    display: flex;\n    flex-direction: row-reverse;\n  }\n}\n</style>\n"]}]}